<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-largerinverses" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Calculating Larger Inverses</title>
  <introduction>
    <p>
      We learned in the previous section what the inverse of a square matrix is and 
      how to calculate the inverse of a <m>2\times 2</m> matrix.  Then we used the matrix
      inverse to solve a linear system with 2 variables.
    </p>
    <p>
      In this section we see another connection between calculating the inverse of a matrix and
      solving a certain linear system of equations, and in doing so, we learn how to calculate the inverse 
      of square matrices larger than <m>2\times 2</m>.
    </p>
  </introduction>

  <subsection xml:id="subsec-largerinverses-bc">
    <title>Prepare</title>
    <p>
      Consider the matrix 
        <me>
          A=\begin{bmatrix} 1 \amp 2 \\ 3 \amp 5 \end{bmatrix}
        </me>.
      We know how to find the inverse of <m>A</m> using the formula in <xref ref="def_inverse"/>,
        <md>
          <mrow> A^{-1}\amp = \frac{1}{ad-bc}\left[\begin{array}{rr|rr} d\amp -b\\-c\amp a \end{array}\right]</mrow>
          <mrow> \amp = \frac{1}{(1)(5)-(2)(3)}\left[\begin{array}{rr|rr} 5\amp -2\\-3\amp 1 \end{array}\right] </mrow>
          <mrow> \amp = \left[\begin{array}{rr|rr} -5\amp 2\\3\amp -1 \end{array}\right] </mrow>
        </md>.
      Let's now find <m>A^{-1}</m> in another way, using a method that will also work on larger matrices.
      Let
      <me>A^{-1}=\begin{bmatrix} x_1 \amp y_1 \\ x_2 \amp y_2 \end{bmatrix}
      </me>. 
      Calculating <m>A^{-1}</m> means we need to solve for the values of <m>x_1, y_1, x_2, y_2</m>.
      We know that <m>A A^{-1}=I</m>, which means that
      <me>
        \begin{bmatrix} 1 \amp 2 \\ 3 \amp 5 \end{bmatrix}\begin{bmatrix} x_1 \amp y_1 \\ x_2 \amp y_2 \end{bmatrix} = \begin{bmatrix} 1 \amp 0 \\ 0 \amp 1 \end{bmatrix}
      </me>,
      and using matrix multiplication on the two matrices above means that
      <me>
        \begin{bmatrix} 1x_1+2x_2 \amp 1y_2+2y_2 \\ 3x_1+5x_2 \amp 3y_1+5y_2 \end{bmatrix} = \begin{bmatrix} 1 \amp 0 \\ 0 \amp 1 \end{bmatrix}
      </me>.
    </p>
    <p>
      Two matrices are equal only when each of their corresponding entries is equal, so this means that
      <md>
        <mrow>1x_1+2x_2 \amp =1 \amp \amp \amp 1y_1+2y_2 \amp =0 </mrow>
        <mrow>3x_1+5x_2 \amp =0 \amp \amp \amp 3y_1+5y_2 \amp =1 </mrow>
      </md>.
    </p>
    <p>
      This looks like two linear systems of equations, one with variables <m>x_1, x_2</m> and another one with variables <m>y_1, y_2</m>.
      We know how to solve a system of linear equations: use an augmented matrix and row reduce.  Let's solve the first system first.
      <!-- <md>
        <mrow>\amp \amp \amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 1 \\ 3 \amp 5 \amp 0 \end{array}\right] \amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 0 \\ 3 \amp 5 \amp 1 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2 \amp \amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 1 \\ 0 \amp -1 \amp -3 \end{array}\right] \amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 0 \\ 0 \amp -1 \amp 1 \end{array}\right] </mrow>
      </md>. -->
    <!-- <sidebyside widths="47.5% 47.5%" margins="0% 0%" valign="middle">
      <p>
      <md>
        <mrow>\amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 1 \\ 3 \amp 5 \amp 0 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 1 \\ 0 \amp -1 \amp -3 \end{array}\right] </mrow>
        <mrow>-R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 1 \\ 0 \amp 1 \amp 3 \end{array}\right] </mrow>
        <mrow>-2R_2+R_1\amp \rightarrow R_1 \amp \amp \left[\begin{array}{cc|c} 1 \amp 0 \amp -5 \\ 0 \amp 1 \amp 3 \end{array}\right] </mrow>
      </md> 
    </p>
    <p>
      <md>
        <mrow>\amp \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 0 \\ 3 \amp 5 \amp 1 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2  \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 0 \\ 0 \amp -1 \amp 1 \end{array}\right] </mrow>
        <mrow>-R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{cc|c} 1 \amp 2 \amp 0 \\ 0 \amp 1 \amp -1 \end{array}\right] </mrow>
        <mrow>-2R_2+R_1\amp \rightarrow R_1 \amp \amp \left[\begin{array}{cc|c} 1 \amp 0 \amp 2 \\ 0 \amp 1 \amp -1 \end{array}\right] </mrow>
      </md>
    </p>
    </sidebyside> -->

      <md>
        <mrow>\amp \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 1 \\ 3 \amp 5 \amp 0 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 1 \\ 0 \amp -1 \amp -3 \end{array}\right] </mrow>
        <mrow>-R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 1 \\ 0 \amp 1 \amp 3 \end{array}\right] </mrow>
        <mrow>-2R_2+R_1\amp \rightarrow R_1 \amp \amp \left[\begin{array}{rr|r} 1 \amp 0 \amp -5 \\ 0 \amp 1 \amp 3 \end{array}\right] </mrow>
      </md> 
    This means that <m>x_1=-5</m> and <m>x_2=3</m>.
    </p>
    <p>
      Now let's solve the second system.  
      <md>
        <mrow>\amp \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 0 \\ 3 \amp 5 \amp 1 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2  \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 0 \\ 0 \amp -1 \amp 1 \end{array}\right] </mrow>
        <mrow>-R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{rr|r} 1 \amp 2 \amp 0 \\ 0 \amp 1 \amp -1 \end{array}\right] </mrow>
        <mrow>-2R_2+R_1\amp \rightarrow R_1 \amp \amp \left[\begin{array}{rr|r} 1 \amp 0 \amp 2 \\ 0 \amp 1 \amp -1 \end{array}\right] </mrow>
      </md>.
    This means that <m>y_1=2</m> and <m>y_2=-1</m>.
    </p>
    <p>
    Putting those values we calculated together results in
    <me>
      A^{-1}=\begin{bmatrix} x_1 \amp y_1 \\ x_2 \amp y_2 \end{bmatrix} = \left[\begin{array}{rr|rr} -5 \amp 2 \\ 3 \amp -1 \end{array}\right]
    </me>,
    and this is indeed the same matrix we had calculated using the formula for <m>2\times 2</m>
    inverses.  
    </p>
    <exercise label="mc-inverseobervations"><title>What do you notice?</title>
      <statement>
        <p>
          We solved for the inverse of <m>A=\begin{bmatrix} 1 \amp 2 \\ 3 \amp 5 \end{bmatrix}</m> by setting up
          <me>
            \begin{bmatrix} 1 \amp 2 \\ 3 \amp 5 \end{bmatrix}\begin{bmatrix} x_1 \amp y_1 \\ x_2 \amp y_2 \end{bmatrix} = \begin{bmatrix} 1 \amp 0 \\ 0 \amp 1 \end{bmatrix}
          </me>,
          and multiplying out and setting corresponding entries equal led to 2 systems of equations to solve:
          <md>
            <mrow>1x_1+2x_2 \amp =1 \amp \amp \amp 1y_1+2y_2 \amp =0 </mrow>
            <mrow>3x_1+5x_2 \amp =0 \amp \amp \amp 3y_1+5y_2 \amp =1 </mrow>
          </md>.
          What do you notice about these 2 systems and the process of solving them?
        </p>
      </statement>
      <choices>
        <choice correct="yes">
          <statement>
            <p>
              The two systems have the same coefficients.
            </p>
          </statement>
        </choice>
        <choice correct="no">
          <statement>
            <p>
              The two systems have the different coefficients.
            </p>
          </statement>
        </choice>
        <choice correct="no">
          <statement>
            <p>
              The two systems have the same constants.
            </p>
          </statement>
        </choice>
        <choice correct="yes">
          <statement>
            <p>
              The two systems have the different constants.
            </p>
          </statement>
        </choice>
        <choice correct="yes">
          <statement>
            <p>
              We used the same sequence of row operations on the augmented matrices to solve the system.
            </p>
          </statement>
        </choice>
        <choice correct="no">
          <statement>
            <p>
              We used a different sequence of row operations on the augmented matrices to solve the system.
            </p>
          </statement>
        </choice>
        <choice correct="no">
          <statement>
            <p>
              The two systems have the same solutions.
            </p>
          </statement>
        </choice>
        <choice correct="yes">
          <statement>
            <p>
              The two systems have different solutions.
            </p>
          </statement>
        </choice>
      </choices>
    </exercise>

    <p>
      The way it worked out in this example is not a coincidence, and the same things are true for larger matrices:
      <ul>
        <li>
          <p>
            Calculating <m>AA^{-1}=I</m>, where <m>A</m> is a known matrix and <m>A^{-1}</m> is a matrix of unknowns, 
            leads to multiple linear systems that all have coefficient matrix <m>A</m>.
          </p>
        </li>
        <li>
          <p>
            In each system, the column matrix corresponding to the constants will be a column of the identity matrix.
          </p>
        </li>
        <li>
          <p>
            Since the coefficient matrices are all the same, we will need the exact same row operations to solve each of the systems.  
          </p>
        </li>
      </ul>
    </p>
    <p>
      Since we did the exact same row operations and put the answers into the columns of <m>A^{-1}</m>, 
      we could have been more efficient and solved both systems at the same time.  
      <md>
        <mrow>\amp \amp \amp \left[\begin{array}{rr|rr} 1 \amp 2 \amp 1 \amp 0 \\ 3 \amp 5 \amp 0 \amp 1 \end{array}\right] </mrow>
        <mrow>-3R_1+R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{rr|rr} 1 \amp 2 \amp 1 \amp 0 \\ 0 \amp -1 \amp -3 \amp 1\end{array}\right] </mrow>
        <mrow>-R_2\amp \rightarrow R_2 \amp \amp \left[\begin{array}{rr|rr} 1 \amp 2 \amp 1 \amp 0 \\ 0 \amp 1 \amp 3 \amp -1\end{array}\right] </mrow>
        <mrow>-2R_2+R_1\amp \rightarrow R_1 \amp \amp \left[\begin{array}{rr|rr} 1 \amp 0 \amp -5 \amp 2\\ 0 \amp 1 \amp 3 \amp -1\end{array}\right] </mrow>
      </md> 
      Note that we started with <m>A</m> on the left and the identity matrix on the right.  After row reducing, 
      the left side turned into the identity matrix, and the right side turned into <m>A^{-1}</m>. 
    </p>
    <p> 
      In math notation,
      <me>
        \bigg[\begin{array}{c|c} A \amp I \end{array}\bigg] \rrefarrow \bigg[\begin{array}{c|c} I \amp A^{-1} \end{array}\bigg]
      </me>.
    </p>
    <p>
      Let's see if that happens again with another example, using Sage to help with the calculations.
    </p>
    <example><title>Calculating the inverse of a larger matrix</title>
      <p>
        We calculate <m>A^{-1}</m> for <m>A = \left[\begin{array}{ccc} 1\amp 1\amp -1\\1\amp -1\amp 1\\1\amp 2\amp 3 \end{array} \right]</m>.
      </p>
      <p>
        We're trying to find an unknown matrix <m>A^{-1}</m> such that <m>AA^{-1}=I</m>. So we set up three
        augmented systems of equations to solve at the same time, resulting in
        <me>
          \left[\begin{array}{ccc|ccc} 1\amp 1\amp -1\amp 1\amp 0\amp 0\\1\amp -1\amp 1\amp 0\amp 1\amp 0\\1\amp 2\amp 3\amp 0\amp 0\amp 1 \end{array} \right]
        </me>.
        Let's let Sage row reduce this for us.  
        <!-- <me>
            \left[\begin{array}{cccccc} 1\amp 0\amp 0\amp 0.5\amp 0.5\amp 0\\0\amp 1\amp 0\amp 0.2\amp -0.4\amp 0.2\\0\amp 0\amp 1\amp -0.3\amp 0.1\amp 0.2 \end{array} \right]
        </me> -->
        <sage>
          <input>
              A=matrix(QQ,3,3,[[1,1,-1],[1,-1,1],[1,2,3]])
              AI=A.augment(identity_matrix(3))
              show(AI,"-->",AI.rref())
          </input>
        </sage>
        Then let's check that the matrix in the last 3 columns really is the inverse of <m>A</m>, by extracting the last
        three columns of the reduced echelon form, and then multiplying that matrix by <m>A</m> to
        make sure we get the identity matrix.
      </p>
      <p>
        Be sure you've already hit <q>Evaluate(Sage)</q> above.  
        <sage>
          <input>
              rrefAI=AI.rref()
              invA=rrefAI.matrix_from_columns([3, 4, 5])
              show(invA)
              show(A*invA)
              show(invA*A)
          </input>
        </sage>
      </p>
    </example>
    <!-- still need discussion of when there isn't an inverse, and the assemblage for the general method.-->
     <!-- next section will be elementary matrices and properties of matrices. -->
    <!-- do two matching within tasks? have A, A^-1, I, inverse does not exist. give A.augment(I) and the rref of this-->
  <!-- do a parsons with the steps to solving for inverse. for reading question. still need one more rq  -->
      
  
      
    <reading-questions xml:id="rqs-largerinverses">
      <exercise label="rq-largerinverses-questions-poll"><title>Reflection</title>
        <task label="rq-largerinverses-confidencepoll-task">
          <query label="rq-largerinverses-confidencepoll" visibility="instructor">
            <statement>
              <p>
                How confident do you feel with the material you just read about?
              </p>
            </statement>
            <choices>
              <choice>
                <statement>
                  <p>
                    Not at all confident or didn't do the reading.
                  </p>
                </statement>
              </choice>
              <choice>
                <statement>
                  <p>
                    Not very confident.
                  </p>
                </statement>
              </choice>
              <choice>
                <statement>
                  <p>
                    Somewhat confident.
                  </p>
                </statement>
              </choice>
              <choice>
                <statement>
                  <p>
                    Mostly confident.
                  </p>
                </statement>
              </choice>
              <choice>
                <statement>
                  <p>
                    Confident so far and ready to engage more deeply.
                  </p>
                </statement>
              </choice>
            </choices>
          </query>
          </task>
          <task label="rq-largerinverses-confidenceresponse">
            <statement>
              <p>
                Ask a question about the material.  What additional information do you think
                someone would need to become more confident in their understanding?
              </p>
            </statement>
            <response/>
          </task>
      </exercise>
    </reading-questions>

  </subsection>

   <!-- <xi:include href="participate-worksheets/dc-.ptx" /> -->
  

  <conclusion xml:id="subsec-largerinverses-summary">
    <title>Summary</title>
    <p>
      <ul>
        <li>
          <p>
              
          </p>
        </li>
        <li>
          <p>
            
          </p>
        </li>
        <li>
          <p>
            
          </p>
        </li>
      </ul>
    </p>
  </conclusion>
  


  <!-- <xi:include href="interactive-exercises/ww-.ptx" /> -->

  <xi:include href="noninteractive-exercises/exer-largerinverses.ptx" />

</section>